---
title: 'End-to-End Fairness Optimization with Decision Focused Learning'
collection: preprints
permalink: /research/working-paper-2
venue: 'Under Review'
pubdate: 'August 2025'
authors: 'Yu Wang, Violet (Xinying) Chen'
---

Manuscript available upon request

**Keywords: equity, fair machine learning, data driven decisions**

Many real-world systems rely on predictive models to inform algorithmic decisions, where fairness concerns can arise both in the prediction stage and in the resulting decisions. We introduce end-to-end fairness optimization (E2EFO) as a unifying framework that integrates fairness across the entire prediction-to-decision pipeline. We focus on resource allocation problems, where a fair prediction task aims to estimate the allocation impacts without disparity, and then a fair decision task seeks to equitably distribute these impacts. Within this framework, we propose fair decision-focused learning (FDFL), a training approach that jointly optimizes for better prediction fairness and decision regret, which measures the loss in decision fairness due to imperfect predictions. To enable gradient-based training, we develop three methods for computing gradients through the decision optimization problem, including exact closed-form gradients for a tractable class of ùõº-fairness maximizing allocation problems and two gradient approximation methods for general fairness-optimizing decisions. In healthcare resource allocation experiments, FDFL consistently achieves lower decision regret and improves prediction fairness with minimal loss in decision quality. This work underscores the value of addressing fairness holistically in data-driven decision systems and offers a practical framework for improving procedural and outcome fairness in high-stakes applications.
